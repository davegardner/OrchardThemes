@using Orchard.Mvc.Html
@using Orchard.ContentManagement
@using Orchard.Utility.Extensions
@{
    if (Model.Title != null) {
        Layout.Title = Model.Title;
    }

    Model.Classes.Add("content-item");

    var contentTypeClassName = ((string)Model.ContentItem.ContentType).HtmlClassify();
    Model.Classes.Add(contentTypeClassName);

    var tag = Tag(Model, "article");

    var bookPart = Model.ContentItem.BookPart;
    var byLine = "";
    if(String.IsNullOrEmpty(bookPart.Author.Value))
    {
        byLine = String.IsNullOrEmpty(bookPart.Illustrator.Value) ? "" : "Illustrated by " + bookPart.Illustrator.Value + ". ";
    }
    else
    {
        byLine = bookPart.Author.Value;
        byLine += String.IsNullOrEmpty(bookPart.Illustrator.Value) ?  "" : ". Illustrated by " + bookPart.Illustrator.Value + ". ";
    }
}
@tag.StartElement
    <div class="book-summary">
        <div class="cover">
            <img src="@bookPart.CoverImage.FirstMediaUrl" />
        </div>
        <div class="blurb">
            <div class="category">@bookPart.Category.Value</div>
            <div class="title">@Html.ItemDisplayLink((String)Model.TitlePart.Title, (ContentItem)Model.ContentItem)</div>
            <div class="byLine">@byLine</div>
            <p>@bookPart.Summary.Value</p>
        </div>
    </div>
@tag.EndElement